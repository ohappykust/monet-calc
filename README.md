# monet-calc — Финансовый дашборд (36 месяцев)

Интерактивный калькулятор финансовой модели для маркетплейса/сервиса с горизонтом 36 месяцев.
Рассчитывает выручку, расходы (штат, маркетинг, инфраструктура), налоговую нагрузку, cash-flow и строит графики. Экспортирует полный отчёт в Excel.

## Возможности
- **Полная реактивность**: все вычисления обновляются автоматически при изменении входных параметров — никаких кнопок «Пересчитать».
- **Единый экспорт в Excel**: в `FinanceDashboard.vue` есть кнопка «Экспорт в Excel» — формируется многостраничный файл с предположениями, штатной таблицей, параметрами и результатами инфраструктуры, помесячными данными (36 мес), сводкой и встроенными изображениями графиков.
- **Сценарии роста**: пресеты Conservative / Realistic / Aggressive с быстрым применением.
- **Инфраструктура**: расчёт RPS, vCPU, RAM, хранилища, Redis и оценочной ежемесячной стоимости. График нагрузки (RPS).
- **Штат**: добавление/удаление ролей, автоматический подсчёт ФОТ и отчислений.

## Технологии
- Vue 3 (Composition API), Vite
- Tailwind CSS
- Chart.js
- ExcelJS (встраивание картинок графиков) с запасным вариантом XLSX

## Структура
- `src/App.vue` — корневой компонент, хранит состояние штата и инфраструктуры. Передаёт их в дашборд.
- `src/components/FinanceDashboard.vue` — основной дашборд, входные параметры, графики, таблица, экспорт в Excel.
- `src/components/StaffSection.vue` — управление ролями и зарплатами (реактивные суммы).
- `src/components/InfraInputs.vue` — ввод параметров инфраструктуры.
- `src/components/InfraResults.vue` — результаты расчёта инфраструктуры и график RPS.
- `src/components/InfraDetailsTable.vue` — детальная таблица инфраструктуры.
- `src/utils/calcFinance.js` — расчёт помесячной финансовой модели (36 мес).
- `src/utils/calcInfra.js` — расчёт инфраструктуры и стоимости.

## Быстрый старт
Требования: Node.js 18+ (рекомендуется 20), npm

```bash
# Установка зависимостей
npm ci

# Запуск dev-сервера
npm run dev

# Сборка production
npm run build

# Локальный предпросмотр собранной версии
npm run preview
```

Dev-сервер стартует на `http://localhost:5173/` (или следующем доступном порту).

## Экспорт в Excel
- Кнопка «Экспорт в Excel» находится в `FinanceDashboard.vue`.
- Используется ExcelJS (в браузере) для создания книги и **встраивания изображений графиков**. Если ExcelJS недоступен, применяется резервный вариант на `xlsx`.
- В экспорт включены: входные предположения, штат, параметры/результаты инфраструктуры, помесячная таблица (36 мес), сводка, изображения графиков.
- Имя файла по умолчанию: `monet_dashboard.xlsx`.

## Реактивность и пересчёт
- Финансовые параметры (объект `params` в `FinanceDashboard.vue`) отслеживаются глубоко: расчёт и графики обновляются автоматически.
- Параметры инфраструктуры (`infraParams` в `App.vue`) также отслеживаются глубоко: `calcInfra()` вызывается автоматически при любом изменении.
- Все кнопки «Пересчитать» удалены.

## Деплой на GitHub Pages (CI)
Автодеплой настроен через GitHub Actions:
- Файл workflow: `.github/workflows/deploy.yml`
- Триггер: push в ветку `main` (и ручной запуск)
- Шаги: `npm ci` → `npm run build` → публикация через `actions/deploy-pages`

Vite автоматически устанавливает корректный `base` для Pages на CI (см. `vite.config.js`):
- Для репозиториев-проектов используется `/<repo>/`.
- Для пользовательских/организационных сайтов (`username.github.io`) — `/`.

После первого успешного деплоя страница будет доступна по адресу:
- Проект: `https://<user>.github.io/<repo>/`
- Пользовательский/организационный: `https://<user>.github.io/`

Если у вас другая основная ветка, поменяйте её в `.github/workflows/deploy.yml`.

### Кастомный домен
- Добавьте файл `public/CNAME` с вашим доменом.
- Настройте CNAME-запись в DNS на `<user>.github.io`.

## Полезно знать
- Первый сборочный бандл может быть крупным из-за `exceljs`. При необходимости можно настроить code-splitting через `build.rollupOptions.output.manualChunks` в `vite.config.js`.
- Если IDE жалуется на Vue global types, убедитесь, что зависимости установлены (`npm ci`), и перезапустите Vue/TS сервер в IDE.

## Лицензия
Не указана. Добавьте раздел по необходимости.
